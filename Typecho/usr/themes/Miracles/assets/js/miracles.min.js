/*
 *  The main JavaScript file for Theme Miracles
 *
 *  @Author:  Eltrac
 *  @License: MIT
 */
function addCookie(name,value,expireHours){var cookieString=name+"="+escape(value);if(expireHours>0){var date=new Date();date.setTime(date.getTime+expireHours*3600*1000);cookieString=cookieString+"; expire="+date.toGMTString()}document.cookie=cookieString}function deleteCookie(name){var date=new Date();date.setTime(date.getTime()-10000);document.cookie=name+"=v; expire="+date.toGMTString()}function getCookie(cname){var name=cname+"=";var decodedCookie=decodeURIComponent(document.cookie);var ca=decodedCookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' '){c=c.substring(1)}if(c.indexOf(name)==0){return c.substring(name.length,c.length)}}return""}function scaleIn(object,time){object.css('transition',time).css('transform','scale(0)');object.show();object.css('transform','scale(1)')}function scaleOut(object,time){object.css('transition',time).css('transform','scale(0)')}function gotoPosition(e){„ÄÄ„ÄÄvar t=e.offsetTop;„ÄÄ„ÄÄvar l=e.offsetLeft;„ÄÄ„ÄÄwhile(e=e.offsetParent){„ÄÄ„ÄÄ„ÄÄ„ÄÄt+=e.offsetTop;„ÄÄ„ÄÄ„ÄÄ„ÄÄl+=e.offsetLeft;„ÄÄ„ÄÄ}„ÄÄ„ÄÄ$("html,body").animate({scrollTop:t},300)}function Dark(){$("body").toggleClass("body-dark");if($("body").hasClass("body-dark")){addCookie("darkTheme","on",9);$("#toggle-dark-button").html('<i class="iconfont icon-sun"></i>');$("#toggle-dark-mobile").html('<i class="iconfont icon-sun"></i>')}else{addCookie("darkTheme","off",9);$("#toggle-dark-button").html('<i class="iconfont icon-moon"></i>');$("#toggle-dark-mobile").html('<i class="iconfont icon-moon"></i>')}}function Gray(){$("html").toggleClass("html-filter-gray");$("html").removeClass("html-filter-sepia");if($("html").hasClass("html-filter-gray")){addCookie("grayFilter","on",0)}else{addCookie("grayFilter","off",0)}}function Sepia(){$("html").toggleClass("html-filter-sepia");$("html").removeClass("html-filter-gray");if($("html").hasClass("html-filter-sepia")){addCookie("sepiaFilter","on",0)}else{addCookie("sepiaFilter","off",0)}}var whetherDark=getCookie("darkTheme");var schemeGeter=window.matchMedia("(prefers-color-scheme: dark)");if(whetherDark=="on"||schemeGeter.matches){$("body").addClass("body-dark");$("#toggle-dark-button").html('<i class="iconfont icon-sun"></i>');$("#toggle-dark-mobile").html('<i class="iconfont icon-sun"></i>')}function swDarkMode(scheme){if(scheme.matches)$("body").addClass("body-dark");else if(window.matchMedia("(prefers-color-scheme: light)").matches)$("body").removeClass("body-dark")}schemeGeter.addListener(swDarkMode);function GoTop(){$('body,html').animate({scrollTop:0},500);document.body.scrollTop=0;document.documentElement.scrollTop=0}$('#gotop').hide();$(window).scroll(function(){if($(window).scrollTop()>450){scaleIn($('#gotop'),'0.7');scaleIn($('#gotop'),'0.7')}else{scaleOut($('#gotop'),'0.7')}});var new_scroll_position=0;var last_scroll_position;var header=$(".nav");window.addEventListener('scroll',function(e){last_scroll_position=window.scrollY;if(new_scroll_position<last_scroll_position&&last_scroll_position>80){header.removeClass("nav-slideDown");header.addClass("nav-slideUp")}else if(new_scroll_position>last_scroll_position){header.removeClass("nav-slideUp");header.addClass("nav-slideDown")}new_scroll_position=last_scroll_position});function LazyLoad(){jQuery(function(){jQuery("img").lazyload({threshold:200,effect:"fadeIn"})})}function highlight(){$(document).ready(function(){$('pre code').each(function(i,block){hljs.highlightBlock(block);hljs.lineNumbersBlock(block,{singleLine:true})})})}function owoLoad(){var OwO_demo=new OwO({logo:'OœâOË°®ÊÉÖ',container:document.getElementsByClassName('OwO')[0],target:document.getElementsByClassName('OwO-textarea')[0],api:owoJson,position:'down',width:'300px',maxHeight:'250px'})}function panguLoad(){document.addEventListener('DOMContentLoaded',()=>{pangu.autoSpacingPage()})}function bodyScroll(event){event.preventDefault()}function Search(){$(".search").toggleClass("ready");$(".search-close").toggleClass("ready")}function Login(){$(".login").toggleClass("ready");$(".login-close").toggleClass("ready")}function toggleDrawer(){$("body").toggleClass("drawer-open");$(".mask").toggleClass("mask-open")}function alertSend(content,type){$("body").append("<div class=\"alert adding "+type+"\">"+content+"</div>");window.setTimeout(function(){$(".alert").removeClass("adding");$(".alert").addClass("remove");window.setTimeout(function(){$(".alert").remove()},200)},2500)}var copyAlertTime=0;$(document).ready(function(){$("body").bind({copy:function(){copyAlertTime++;if(copyAlertTime==1){alertSend("Â§çÂà∂ÊàêÂäüÔºÅËã•‰ΩøÁî®ËØ∑Ê≥®ÊòéÂéü‰ΩúËÄÖÂèäÂéüÂú∞ÂùÄÔºÅ");window.setTimeout(function(){copyAlertTime=0},200)}}})});var goTopButton=$("#gotop");var fullMask=$("#full-mask");var searchCloseButton=$("#search-close-button");var searchOpenButton=$("#search-open-button");var searchOpenMobile=$("#search-open-mobile");var loginCloseButton=$("#login-close");var loginOpenButton=$("#login-open");var loginOpenMobile=$("#login-open-mobile");var toggleMobileMenuClose=$("#toggle-mobile-menu-close");var toggleMobileMenu=$("#toggle-mobile-menu-button");var drawerButton=$("#drawer-button");var navBar=$("#navBar");var navBarMobile=$("#navBarMobile");var darkToggle=$("#toggle-dark-button");var darkToggleMobile=$("#toggle-dark-mobile");goTopButton.on("click",GoTop);fullMask.on("click",function(){toggleDrawer()});drawerButton.on("click",toggleDrawer);searchCloseButton.on("click",Search);searchOpenButton.on("click",Search);if(searchOpenMobile){searchOpenMobile.on("click",function(){Search();toggleDrawer()})}loginCloseButton.on("click",Login);loginOpenButton.on("click",Login);if(loginOpenMobile){loginOpenMobile.on("click",function(){Login();toggleDrawer()})}if(toggleMobileMenuClose){toggleMobileMenuClose.on("click",function(){$(".mobile-menu").toggleClass("ready");$(".mobile-menu-close").toggleClass("ready")})}if(toggleMobileMenu){toggleMobileMenu.on("click",function(){$(".mobile-menu").toggleClass("ready");$(".mobile-menu-close").toggleClass("ready")})}darkToggle.on("click",Dark);if(darkToggleMobile){darkToggleMobile.on("click",Dark)}if(navBar){var navBar_height=navBar.clientHeight;function navUpdate(){if(allowNavAero==true){var scrollTop=document.documentElement.scrollTop||document.body.scrollTop;if(scrollTop>navBar_height){navBar.removeClass("nav-aero");navBarMobile.removeClass("nav-aero");$(".nav-icon-button").css("color","#000")}else{navBar.addClass("nav-aero");navBarMobile.addClass("nav-aero");if($(".index-banner").css("background-image")=="url('')"){$(".nav-icon-button").css("color","#000")}else{$(".nav-icon-button").css("color","#fff")}}}}$(window).scroll(function(){navUpdate()})}function navColor(){if($("#banner-content").hasClass("banner-font-black")){if(navBar){navBar.addClass("nav-font-white")}if(navBarMobile){navBarMobile.addClass("nav-font-white")}}else{if(navBar){navBar.removeClass("nav-font-white")}if(navBarMobile){navBarMobile.removeClass("nav-font-white")}}}function getWordsNum(){if($("#post-content"))str=$("#post-content").text();else return false;sLen=0;str=str.replace(/(\r\n+|\s+|„ÄÄ+)/g,"Èæò");str=str.replace(/[\x00-\xff]/g,"m");str=str.replace(/m+/g,"*");str=str.replace(/Èæò+/g,"");sLen=str.length;time=Math.ceil(sLen/450);$("#readTip").html("Êú¨ÊñáÁ∫¶ "+sLen+"Â≠ó ÈòÖËØªÂ§ßÊ¶ÇÈúÄË¶Å "+time+" ÂàÜÈíü")}function startTime(time='2010-01-01'){startTimeV=time;var $time=new Date().getTime()-new Date(startTimeV);if($time<0)return'0Áßí';let result='';if($time>=365*86400000){result+=parseInt($time/(365*86400000))+' Âπ¥ ';$time=($time%(365*86400000))}if($time>=86400000){result+=parseInt($time/86400000)+' Â§© ';$time=($time%86400000)}if($time>=3600000){result+=parseInt($time/3600000)+' Â∞èÊó∂ ';$time=($time%3600000)}if($time>=60000){result+=parseInt($time/60000)+' ÂàÜ ';$time=($time%60000)}result+=parseInt($time/1000)+' Áßí ';$('#build-time').html(result);buildTimeout=setTimeout('startTime(startTimeV)',1000)}function linkTarget(){var all_a=document.getElementsByTagName("a");host_url=window.location.host;for(var i=0;i<all_a.length;i++){var domain=all_a[i].href.split("/");if(domain[2]!=host_url){all_a[i].target="_blank"}}}linkTarget();if(loadPjax=true){$(document).pjax('a[href^="'+siteurl+'"]:not(a[target="_blank"], a[no-pjax], .comment-reply a, .cancel-comment-reply a)',{container:'#pjax-container',fragment:'#pjax-container',timeout:8000}).on('pjax:send',function(){GoTop();beforePjax()}).on('pjax:complete',function(){$('form#login-form').addClass('need-refresh');$(".mobile-menu").addClass("ready");$(".mobile-menu-close").addClass("ready");$(".post-list").addClass("fadein").hide().fadeIn(300);$(".post-body").addClass("fadein").hide().fadeIn(300);$(".comment").addClass("fadein").hide().fadeIn(300);$("#pjax-container").css({'height':'auto'});NProgress.done();LazyLoad();highlight();panguLoad();getWordsNum();navColor();linkTarget();MiraclesComment.bindReplyBtn();MiraclesComment.core();afterPjax()})}(function(){panguLoad();LazyLoad();highlight();if(navBar){navUpdate()}getWordsNum();if(navBar){navColor()}})();console.log("%c üéâ Theme Miracles %c by Eltrac https://guhub.cn %c ","color: #fff; margin: 1em 0; padding: 5px 0; background: #29c75f;","margin: 1em 0; padding: 5px 0; background: #efefef;","display: block;margin-left:-0.5em;");